!function(n,t,e,i){"use strict";function a(t,e){this.$element=n(t),this.settings=n.extend({},o,e),this._defaults=o,this._name=s,this.init(this.$element)}var s="osdi",o={autoresponse:!0,done:function(){},fail:function(){},always:function(){},status:"subscribed",ajax_options:{type:"POST",dataType:"json",contentType:"application/json"}};n.extend(a.prototype,{init:function(n){this.validate_form(n)&&this.form_submit(n,this)},validate_form:function(n){return n.is("form")?!0:(console.log("JQUERY OSDI ERROR: The DOM element passed to the jQuery OSDI plugin is not a form. The jQuery OSDI plugin only supports form elements."),!1)},form_submit:function(t,e){t.on("submit",function(){if(e.validate_submit(t)){var i,a,s,o,d,l;i=e.create_body(t),a=e.settings.endpoint&&""!=e.settings.endpoint?e.settings.endpoint:t.attr("action"),s={url:a,data:JSON.stringify(i)},s=n.extend(s,e.settings.ajax_options),o=e.settings.done,d=e.settings.fail,l=e.settings.always,e.perform_ajax(s,o,d,l)}return!1})},validate_submit:function(n){return this.validate_endpoint(n)&&this.validate_add_tags()?!0:!1},validate_endpoint:function(n){return this.settings.endpoint||n.attr("action")?!0:(console.log("JQUERY OSDI ERROR: An endpoint is required. Either set the endpoint option with a string when calling the jQuery OSDI plugin, or give your form an action attribute with the endpoint as its value."),!1)},validate_add_tags:function(){return this.settings.add_tags&&(!n.isArray(this.settings.add_tags)||!this.settings.add_tags.length>0)?(console.log("JQUERY OSDI ERROR: The add_tags option is not a valid array of at least one element. You must pass an array with at least one element to the jQuery OSDI plugin to add tags."),!1):!0},create_body:function(t){var e,i,a,s,o,d,l;return this.settings.body?e=this.settings.body():(e={person:{}},this.settings.autoresponse&&(i={triggers:{autoresponse:{enabled:!0}}},n.extend(e,i)),this.settings.add_tags&&(l={add_tags:this.settings.add_tags},n.extend(e,l)),t.find('input[name="family_name"]').length&&""!=t.find('input[name="family_name"]').val()&&(e.person.family_name=t.find('input[name="family_name"]').val()),t.find('input[name="given_name"]').length&&""!=t.find('input[name="given_name"]').val()&&(e.person.given_name=t.find('input[name="given_name"]').val()),t.find('input[name="email_address"]').length&&""!=t.find('input[name="email_address"]').val()&&(a={email_addresses:[{address:t.find('input[name="email_address"]').val()}]},n.extend(e.person,a),this.settings.status&&(e.person.email_addresses[0].status=this.settings.status)),(t.find('input[name="street"]').length&&""!=t.find('input[name="street"]').val()||t.find('input[name="locality"]').length&&""!=t.find('input[name="locality"]').val()||t.find('input[name="region"]').length&&""!=t.find('input[name="region"]').val()||t.find('input[name="postal_code"]').length&&""!=t.find('input[name="postal_code"]').val()||t.find('input[name="country"]').length&&""!=t.find('input[name="country"]').val())&&(s={},t.find('input[name="street"]').length&&""!=t.find('input[name="street"]').val()&&(s.address_lines=[t.find('input[name="street"]').val()]),t.find('input[name="locality"]').length&&""!=t.find('input[name="locality"]').val()&&(s.locality=t.find('input[name="locality"]').val()),t.find('input[name="region"]').length&&""!=t.find('input[name="region"]').val()&&(s.region=t.find('input[name="region"]').val()),t.find('input[name="postal_code"]').length&&""!=t.find('input[name="postal_code"]').val()&&(s.postal_code=t.find('input[name="postal_code"]').val()),t.find('input[name="country"]').length&&""!=t.find('input[name="country"]').val()&&(s.country=t.find('input[name="country"]').val()),o={postal_addresses:[s]},n.extend(e.person,o)),t.find('input[name="phone_number"]').length&&""!=t.find('input[name="phone_number"]').val()&&(d={phone_numbers:[{number:t.find('input[name="phone_number"]').val()}]},n.extend(e.person,d))),e},perform_ajax:function(t,e,i,a){n.ajax(t).done(function(n,t,i){e(n,t,i)}).fail(function(n,t,e){i(n,t,e)}).always(function(n,t,e){a(n,t,e)})}}),n.fn[s]=function(t){return this.each(function(){n.data(this,"plugin_"+s)||n.data(this,"plugin_"+s,new a(this,t))})}}(jQuery,window,document);